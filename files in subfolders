Sub ListeUnterordnerInhalte()
    Dim Dateipfad As String
    Dim Ordner As Object
    Dim Unterordner As Object
    Dim Datei As Object
    Dim AktuellesBlatt As Worksheet
    Dim NeueTabelle As Worksheet
    Dim LetzteZeile As Long
    Dim OrdnerName As String
    
    ' Dateipfad aus Zelle A1 des aktiven Arbeitsblatts lesen
    Dateipfad = ActiveSheet.Range("A1").Value
    
    ' Aktives Arbeitsblatt speichern
    Set AktuellesBlatt = ActiveSheet
    
    ' Schleife über die sechs Unterordner
    For Each Ordner In CreateObject("Scripting.FileSystemObject").GetFolder(Dateipfad).Subfolders
        ' Unterordnername ermitteln
        OrdnerName = Ordner.Name
        
        ' Neue Tabelle erstellen
        Set NeueTabelle = Worksheets.Add(After:=Worksheets(Worksheets.Count))
        NeueTabelle.Name = OrdnerName
        
        ' Überschrift in der neuen Tabelle einfügen
        NeueTabelle.Range("A1").Value = "Dateiname"
        NeueTabelle.Range("B1").Value = "Erstellungsdatum"
        NeueTabelle.Range("C1").Value = "Letzte Änderung"
        
        ' Zeilennummer initialisieren
        LetzteZeile = 2
        
        ' Schleife über die Dateien im aktuellen Unterordner
        For Each Datei In Ordner.Files
            ' Dateiname in Spalte A einfügen
            NeueTabelle.Range("A" & LetzteZeile).Value = Datei.Name
            
            ' Erstellungsdatum in Spalte B einfügen
            NeueTabelle.Range("B" & LetzteZeile).Value = Datei.DateCreated
            
            ' Letzte Änderung in Spalte C einfügen
            NeueTabelle.Range("C" & LetzteZeile).Value = Datei.DateLastModified
            
            ' Zeilennummer erhöhen
            LetzteZeile = LetzteZeile + 1
        Next Datei
        
        ' Tabelle formatieren
        With NeueTabelle
            .Columns("A:C").AutoFit
            .Range("A1:C1").Font.Bold = True
        End With
    Next Ordner
    
    ' Aktives Arbeitsblatt wiederherstellen
    AktuellesBlatt.Activate
End Sub



