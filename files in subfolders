Sub ListFolderContents()
    Dim fso As New Scripting.FileSystemObject
    Dim folderPath As String
    Dim folder As Scripting.Folder
    Dim subfolder As Scripting.Folder
    Dim file As Scripting.File
    Dim tbl As ListObject
    Dim row As ListRow
    Dim col As Integer
    
    folderPath = ActiveSheet.Range("A1").Value
    Set folder = fso.GetFolder(folderPath)
    
    For Each subfolder In folder.SubFolders
        Set tbl = ActiveSheet.ListObjects.Add(xlSrcRange, Range("A" & Rows.Count).End(xlUp).Offset(2), , xlYes)
        tbl.Name = subfolder.Name
        tbl.ListColumns.Add
        tbl.ListColumns(1).Name = "Filename"
        tbl.ListColumns.Add
        tbl.ListColumns(2).Name = "Created Date"
        tbl.ListColumns.Add
        tbl.ListColumns(3).Name = "Last Modified Date"
        
        For Each file In subfolder.Files
            Set row = tbl.ListRows.Add
            row.Range(1).Value = file.Name
            row.Range(2).Value = file.DateCreated
            row.Range(3).Value = file.DateLastModified
        Next file
    Next subfolder
End Sub
