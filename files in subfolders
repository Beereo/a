Sub ListFilesInFolders()

    ' Dateipfad aus der ersten Zelle des Sheets auslesen
    Dim folderPath As String
    folderPath = Range("A1").Value

    ' Dateisystem-Objekt erstellen
    Dim fso As New FileSystemObject
    Dim folder As Folder
    Set folder = fso.GetFolder(folderPath)

    ' Eine neue Tabelle für jeden Unterordner erstellen
    Dim ws As Worksheet
    For Each SubFolder In folder.SubFolders
        Set ws = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
        ws.Name = SubFolder.Name

        ' Tabellenkopfzeile erstellen
        ws.Range("A1:C1").Value = Array("Name", "Erstellt am", "Geändert am")

        ' Dateien in den Unterordner auflisten
        Dim file As file
        Dim row As Long
        row = 2 ' erste Dateneinträge beginnen in der zweiten Zeile
        For Each file In SubFolder.Files
            If Left(file.Path, Len(SubFolder.Path)) = SubFolder.Path Then
                ' Datei befindet sich im aktuellen Unterordner
                ws.Range("A" & row).Value = file.Name
                ws.Range("B" & row).Value = file.DateCreated
                ws.Range("C" & row).Value = file.DateLastModified
                row = row + 1
            End If
        Next file

        ' Spalten B und C als Datum formatieren
        Dim lastRow As Long
        lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
        With ws.Range("B2:C" & lastRow)
            .NumberFormat = "dd.mm.yyyy hh:mm:ss"
        End With
    Next SubFolder
End Sub



